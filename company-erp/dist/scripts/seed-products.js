"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@nestjs/core");
const app_module_1 = require("../app.module");
const products_service_1 = require("../modules/products/products.service");
const seed_utils_1 = require("./seed-utils");
async function main() {
    const count = (0, seed_utils_1.getArgNumber)('count', 100);
    const start = (0, seed_utils_1.getArgNumber)('start', Date.now());
    const app = await core_1.NestFactory.createApplicationContext(app_module_1.AppModule, {
        logger: ['log', 'warn', 'error'],
    });
    try {
        const productsService = app.get(products_service_1.ProductsService);
        let created = 0;
        for (let i = 0; i < count; i++) {
            const sku = `SKU-${start}-${i}`;
            const name = `Seed Product ${i + 1}`;
            const stock = (0, seed_utils_1.randInt)(0, 200);
            const price = Number(((0, seed_utils_1.randInt)(100, 50000) / 100).toFixed(2));
            await productsService.create({
                sku,
                name,
                description: `Seeded product generated by script (${sku})`,
                stock,
                price,
            });
            created++;
            if (created % 25 === 0)
                console.log(`Created ${created}/${count} products...`);
        }
        console.log(`Done. Created ${created} products.`);
    }
    finally {
        await app.close();
    }
}
main().catch((err) => {
    console.error(err);
    process.exit(1);
});
//# sourceMappingURL=seed-products.js.map